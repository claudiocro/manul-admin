{"version":3,"sources":["../../src/hocs/with_aggregation.js"],"names":["composer","onData","context","config","collectionName","aggregationName","docs","aggregations","aggregation","Error","aggregate","columns","docsAggregated","isAggregation","type"],"mappings":";;;;;;;;;;;AACA;;;;AAIO,IAAMA,8BAAW,SAAXA,QAAW;AAAA,SAAM,gBAC8CC,MAD9C,EAEzB;AAAA,QADDC,OACC,QADDA,OACC;AAAA,QADQC,MACR,QADQA,MACR;AAAA,QADgBC,cAChB,QADgBA,cAChB;AAAA,QADgCC,eAChC,QADgCA,eAChC;AAAA,QADiDC,IACjD,QADiDA,IACjD;AAAA,QADuDC,YACvD,QADuDA,YACvD;;AACH,QAAMC,cAAc,mBAAIH,eAAJ,EAAqBE,YAArB,CAApB;AACA,QAAI,CAACC,WAAL,EAAkB;AAChBP,aAAO,IAAIQ,KAAJ,yBAAgCJ,eAAhC,CAAP;AACD,KAFD,MAEO;AAAA,UACGK,SADH,GAC+BF,WAD/B,CACGE,SADH;AAAA,iCAC+BF,WAD/B,CACcG,OADd;AAAA,UACcA,OADd,wCACwB,EADxB;;AAEL,UAAMC,iBAAiBF,UAAUJ,IAAV,CAAvB;AACAL,aAAO,IAAP,EAAa;AACXK,cAAMM,cADK;AAEXD,wBAFW;AAGXE,uBAAe;AAHJ,OAAb;AAKD;AACF,GAfuB;AAAA,CAAjB;;kBAkBQ;AAAA,SAAQ,oCAAmBb,SAASc,IAAT,CAAnB,CAAR;AAAA,C","file":"with_aggregation.js","sourcesContent":["\nimport { composeWithTracker } from 'mantra-core';\n\nimport { get } from 'lodash/fp';\n\nexport const composer = () => (\n  { context, config, collectionName, aggregationName, docs, aggregations }, onData,\n) => {\n  const aggregation = get(aggregationName)(aggregations);\n  if (!aggregation) {\n    onData(new Error(`unkown aggregation:${aggregationName}`));\n  } else {\n    const { aggregate, columns = [] } = aggregation;\n    const docsAggregated = aggregate(docs);\n    onData(null, {\n      docs: docsAggregated,\n      columns,\n      isAggregation: true,\n    });\n  }\n};\n\n\nexport default type => composeWithTracker(composer(type));\n"]}